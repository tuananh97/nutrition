<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân Tích Dinh Dưỡng - Bệnh nhân nam 28 tuổi</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3 {
            margin-top: 0;
        }
        
        .patient-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .info-item {
            margin-right: 20px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .summary-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            color: white;
            margin-bottom: 15px;
        }
        
        .energy-box {
            background-color: var(--primary-color);
        }
        
        .protein-box {
            background-color: var(--secondary-color);
        }
        
        .carbs-box {
            background-color: var(--warning-color);
        }
        
        .fat-box {
            background-color: var(--danger-color);
        }
        
        .recommendations {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .recommendation-item {
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 3px solid var(--primary-color);
        }
        
        .status-good {
            color: var(--secondary-color);
            font-weight: bold;
        }
        
        .status-warning {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .status-danger {
            color: var(--danger-color);
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--light-color);
        }
        
        .highlight {
            background-color: rgba(52, 152, 219, 0.1);
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Phân Tích Dinh Dưỡng</h1>
            <p>Bệnh nhân nam 28 tuổi, 45kg, 165cm - Ăn qua sonde dạ dày PEG và uống đồ lỏng</p>
        </header>
        
        <div class="patient-info">
            <div class="info-item">
                <h3>Thông tin bệnh nhân</h3>
                <p>Tuổi: 28 | Giới tính: Nam</p>
                <p>Cân nặng: 45kg | Chiều cao: 165cm</p>
                <p>BMI: 16.5 <span class="status-danger">(Suy dinh dưỡng độ II)</span></p>
            </div>
            <div class="info-item">
                <h3>Mục tiêu dinh dưỡng</h3>
                <p>Năng lượng: 1700 kcal/ngày</p>
                <p>Protein: 75g | Chất béo: 65g | Carb: 190g | Chất xơ: 25g</p>
            </div>
            <div class="info-item">
                <h3>Chế độ ăn hiện tại</h3>
                <p>6 bữa/ngày: 3 bữa súp xay, 2 bữa sữa 230kcal, 1 nước trái cây, 1 sinh tố</p>
            </div>
        </div>
        
        <div class="dashboard-grid">
            <div class="card">
                <h2>Tổng Quan Năng Lượng</h2>
                <div class="chart-container">
                    <canvas id="energyChart"></canvas>
                </div>
                <p>Trung bình: <span id="avgEnergy">1853.9</span> kcal/ngày</p>
                <p>So với mục tiêu (1700 kcal): <span class="status-warning">+153.9 kcal</span></p>
            </div>
            
            <div class="card">
                <h2>Phân Bố Dinh Dưỡng</h2>
                <div class="chart-container">
                    <canvas id="macronutrientChart"></canvas>
                </div>
                <p>Tỷ lệ trung bình: Carb <span id="avgCarbsPct">45.2%</span>, Protein <span id="avgProteinPct">20.4%</span>, Fat <span id="avgFatPct">34.4%</span></p>
            </div>
            
            <div class="card">
                <h2>So Sánh với Mục Tiêu</h2>
                <div class="summary-box energy-box">
                    <h3>Năng lượng</h3>
                    <p>1853.9 kcal vs 1700 kcal</p>
                    <p class="status-warning">+9.1% so với mục tiêu</p>
                </div>
                <div class="summary-box protein-box">
                    <h3>Protein</h3>
                    <p>96.2g vs 75g</p>
                    <p class="status-good">+28.3% so với mục tiêu</p>
                </div>
                <div class="summary-box carbs-box">
                    <h3>Carbohydrate</h3>
                    <p>206.7g vs 190g</p>
                    <p class="status-warning">+8.8% so với mục tiêu</p>
                </div>
                <div class="summary-box fat-box">
                    <h3>Chất béo</h3>
                    <p>82.8g vs 65g</p>
                    <p class="status-danger">+27.4% so với mục tiêu</p>
                </div>
            </div>
        </div>
        
        <div class="dashboard-grid">
            <div class="card">
                <h2>Chất Xơ & Đường</h2>
                <div class="chart-container">
                    <canvas id="fiberSugarChart"></canvas>
                </div>
                <p>Chất xơ trung bình: <span id="avgFiber">31.9g</span> vs Mục tiêu: 25g <span class="status-good">(Đạt)</span></p>
                <p>Đường trung bình: <span id="avgSugar">56.7g</span> <span class="status-warning">(Cao)</span></p>
            </div>
            
            <div class="card">
                <h2>Vitamin & Khoáng Chất</h2>
                <div class="chart-container">
                    <canvas id="vitaminChart"></canvas>
                </div>
                <p>Hầu hết vitamin và khoáng chất đạt hoặc vượt nhu cầu, trừ Vitamin D có thể cần bổ sung thêm.</p>
            </div>
            
            <div class="card">
                <h2>Chất Béo Chi Tiết</h2>
                <div class="chart-container">
                    <canvas id="fatBreakdownChart"></canvas>
                </div>
                <p>Tỷ lệ chất béo không bão hòa: <span id="unsaturatedRatio">72.6%</span> <span class="status-good">(Tốt)</span></p>
                <p>Omega-3/Omega-6: <span id="omegaRatio">1:3.2</span> <span class="status-warning">(Cần cải thiện)</span></p>
            </div>
        </div>
        
        <div class="recommendations">
            <h2>Đánh Giá & Khuyến Nghị</h2>
            
            <div class="recommendation-item">
                <h3>1. Tình trạng dinh dưỡng</h3>
                <p>BMI = 16.5 (Suy dinh dưỡng độ II). Cân nặng lý tưởng cho chiều cao 165cm là 55-60kg.</p>
                <p><span class="status-danger">Nguy cơ ngắn hạn:</span> Mệt mỏi, giảm miễn dịch, táo bón (dù chất xơ đạt)</p>
                <p><span class="status-danger">Nguy cơ dài hạn:</span> Loãng xương, thiếu máu, sụt cân thêm</p>
            </div>
            
            <div class="recommendation-item">
                <h3>2. Điều chỉnh tỷ lệ dinh dưỡng</h3>
                <p>Hiện tại: Carb 45.2%, Protein 20.4%, Fat 34.4%</p>
                <p>Mục tiêu: Carb 45%, Protein 20%, Fat 35%</p>
                <p><span class="status-good">Tỷ lệ gần đạt mục tiêu</span>, nhưng cần giảm tổng năng lượng và chất béo.</p>
            </div>
            
            <div class="recommendation-item">
                <h3>3. Khuyến nghị điều chỉnh</h3>
                <p><strong>Giảm năng lượng:</strong> Từ 1854 kcal xuống ~1700 kcal (giảm ~150 kcal)</p>
                <p><strong>Giảm chất béo:</strong> Từ 82.8g xuống ~65g (giảm ~18g)</p>
                <p><strong>Duy trì protein:</strong> 96.2g hiện tại là tốt cho phục hồi</p>
                <p><strong>Giảm carbohydrate:</strong> Từ 206.7g xuống ~190g (giảm ~17g)</p>
            </div>
            
            <div class="recommendation-item">
                <h3>4. Biện pháp cụ thể</h3>
                <p>- Giảm 1/2 khẩu phần sữa (230kcal → 115kcal) hoặc thay bằng sữa ít béo</p>
                <p>- Giảm lượng dầu/mỡ trong súp xay (khoảng 2-3 muỗng cà phê/ngày)</p>
                <p>- Duy trì lượng chất xơ hiện tại (31.9g) vì tốt cho tiêu hóa</p>
                <p>- Bổ sung thực phẩm giàu vitamin D: cá hồi xay, lòng đỏ trứng vào súp</p>
                <p>- Xem xét bổ sung kẽm và vitamin B-complex nếu cần</p>
            </div>
            
            <div class="recommendation-item">
                <h3>5. Tối ưu hóa chế độ ăn</h3>
                <p>- Duy trì 6 bữa/ngày, phân bổ đều năng lượng</p>
                <p>- Tăng dần năng lượng khi cân nặng cải thiện (mục tiêu +0.5kg/tuần)</p>
                <p>- Theo dõi cân nặng hàng tuần và điều chỉnh kế hoạch</p>
                <p>- Ưu tiên thực phẩm giàu đạm chất lượng cao, chất béo tốt</p>
            </div>
        </div>
        
        <footer>
            <p>Báo cáo được tạo dựa trên dữ liệu dinh dưỡng từ ngày 01/11/2025 đến 30/11/2025</p>
            <p>Lưu ý: Thông tin này chỉ mang tính chất tham khảo, vui lòng tham khảo ý kiến chuyên gia dinh dưỡng để có kế hoạch cá nhân hóa</p>
        </footer>
    </div>

    <script>
        // Dữ liệu từ CSV
        const nutritionData = [
            { date: '01/11/2025', energy: 1847.1, carbs: 190.3, fiber: 23.9, sugars: 46.2, fat: 83.3, protein: 92.9, vitA: 1196.3, vitC: 235.9, vitD: 508.5, vitE: 16.4, calcium: 1180.1, iron: 15.2, magnesium: 418.0, potassium: 3626.5, sodium: 1499.6, zinc: 13.7, mono: 33.2, omega3: 3.6, omega6: 11.2 },
            { date: '02/11/2025', energy: 1749.8, carbs: 185.9, fiber: 27.5, sugars: 47.2, fat: 78.7, protein: 90.7, vitA: 1383.9, vitC: 207.8, vitD: 441.2, vitE: 14.5, calcium: 1138.3, iron: 11.8, magnesium: 461.3, potassium: 3815.8, sodium: 1434.3, zinc: 12.2, mono: 27.8, omega3: 3.2, omega6: 13.6 },
            { date: '03/11/2025', energy: 1819.9, carbs: 199.8, fiber: 30.6, sugars: 57.9, fat: 81.8, protein: 91.3, vitA: 1200.9, vitC: 228.2, vitD: 396.2, vitE: 19.1, calcium: 1239.2, iron: 14.8, magnesium: 497.7, potassium: 3598.5, sodium: 1845.0, zinc: 13.5, mono: 29.1, omega3: 3.9, omega6: 15.8 },
            { date: '04/11/2025', energy: 1865.5, carbs: 208.2, fiber: 30.7, sugars: 64.1, fat: 81.8, protein: 91.0, vitA: 1591.8, vitC: 153.8, vitD: 451.7, vitE: 14.7, calcium: 1155.1, iron: 14.1, magnesium: 474.2, potassium: 4126.1, sodium: 1566.2, zinc: 14.3, mono: 28.3, omega3: 3.7, omega6: 15.5 },
            { date: '05/11/2025', energy: 1927.5, carbs: 202.8, fiber: 28.1, sugars: 60.6, fat: 90.0, protein: 96.0, vitA: 1034.4, vitC: 228.7, vitD: 509.7, vitE: 15.7, calcium: 1238.2, iron: 16.2, magnesium: 489.9, potassium: 4041.1, sodium: 1473.3, zinc: 14.2, mono: 31.9, omega3: 5.1, omega6: 16.3 },
            { date: '06/11/2025', energy: 1726.0, carbs: 196.2, fiber: 28.5, sugars: 57.7, fat: 71.2, protein: 90.0, vitA: 1090.2, vitC: 298.4, vitD: 444.4, vitE: 17.7, calcium: 1166.0, iron: 14.9, magnesium: 440.1, potassium: 4067.1, sodium: 1466.5, zinc: 12.1, mono: 26.7, omega3: 2.3, omega6: 9.4 },
            { date: '07/11/2025', energy: 1822.0, carbs: 202.6, fiber: 34.4, sugars: 48.2, fat: 81.5, protein: 89.1, vitA: 1278.2, vitC: 256.0, vitD: 442.9, vitE: 17.4, calcium: 1226.3, iron: 12.8, magnesium: 470.3, potassium: 4648.6, sodium: 1937.2, zinc: 11.5, mono: 27.2, omega3: 3.7, omega6: 15.1 },
            { date: '08/11/2025', energy: 1897.1, carbs: 205.2, fiber: 32.6, sugars: 58.5, fat: 82.5, protein: 101.1, vitA: 1478.0, vitC: 223.8, vitD: 455.7, vitE: 15.3, calcium: 1154.0, iron: 13.9, magnesium: 475.4, potassium: 4237.4, sodium: 1490.9, zinc: 15.2, mono: 28.7, omega3: 3.7, omega6: 15.6 },
            { date: '09/11/2025', energy: 1937.7, carbs: 204.0, fiber: 33.7, sugars: 58.0, fat: 91.0, protein: 96.7, vitA: 1289.4, vitC: 250.5, vitD: 512.9, vitE: 16.5, calcium: 1292.2, iron: 14.8, magnesium: 458.1, potassium: 3957.6, sodium: 1540.3, zinc: 13.4, mono: 30.6, omega3: 7.3, omega6: 16.5 },
            { date: '10/11/2025', energy: 1908.4, carbs: 202.1, fiber: 32.3, sugars: 55.9, fat: 84.6, protein: 100.4, vitA: 981.1, vitC: 220.5, vitD: 475.7, vitE: 14.9, calcium: 1166.2, iron: 13.8, magnesium: 438.8, potassium: 4167.6, sodium: 1476.3, zinc: 14.0, mono: 27.6, omega3: 5.9, omega6: 16.3 },
            { date: '11/11/2025', energy: 1896.3, carbs: 210.7, fiber: 34.4, sugars: 61.8, fat: 83.8, protein: 93.6, vitA: 1778.6, vitC: 285.6, vitD: 441.2, vitE: 17.0, calcium: 1184.2, iron: 11.1, magnesium: 428.9, potassium: 3883.3, sodium: 1484.4, zinc: 11.4, mono: 27.0, omega3: 5.9, omega6: 16.0 },
            { date: '12/11/2025', energy: 1924.0, carbs: 217.6, fiber: 36.9, sugars: 57.5, fat: 84.3, protein: 97.4, vitA: 997.7, vitC: 167.0, vitD: 474.1, vitE: 15.7, calcium: 1189.5, iron: 14.5, magnesium: 543.2, potassium: 4412.0, sodium: 1494.8, zinc: 14.9, mono: 31.9, omega3: 4.4, omega6: 11.5 },
            { date: '13/11/2025', energy: 1914.1, carbs: 210.3, fiber: 34.1, sugars: 63.4, fat: 84.0, protein: 97.0, vitA: 1621.3, vitC: 120.3, vitD: 454.1, vitE: 13.1, calcium: 1191.4, iron: 12.0, magnesium: 449.7, potassium: 4012.3, sodium: 1570.7, zinc: 13.8, mono: 27.3, omega3: 5.8, omega6: 16.0 },
            { date: '14/11/2025', energy: 1955.8, carbs: 215.5, fiber: 33.7, sugars: 59.5, fat: 85.2, protein: 99.1, vitA: 939.3, vitC: 114.2, vitD: 441.5, vitE: 15.4, calcium: 1207.9, iron: 10.7, magnesium: 459.0, potassium: 3929.2, sodium: 1510.2, zinc: 11.4, mono: 27.3, omega3: 5.9, omega6: 16.3 },
            { date: '15/11/2025', energy: 1899.1, carbs: 205.0, fiber: 29.5, sugars: 64.8, fat: 83.9, protein: 96.6, vitA: 1620.7, vitC: 131.8, vitD: 454.1, vitE: 13.7, calcium: 1183.9, iron: 12.6, magnesium: 443.7, potassium: 3982.3, sodium: 1581.2, zinc: 13.7, mono: 27.2, omega3: 5.9, omega6: 15.9 },
            { date: '16/11/2025', energy: 1884.7, carbs: 195.7, fiber: 29.8, sugars: 44.9, fat: 84.7, protein: 100.8, vitA: 1015.3, vitC: 215.0, vitD: 441.5, vitE: 16.7, calcium: 1227.7, iron: 11.7, magnesium: 485.9, potassium: 4160.8, sodium: 1642.8, zinc: 11.6, mono: 27.0, omega3: 5.9, omega6: 16.0 },
            { date: '17/11/2025', energy: 1789.2, carbs: 199.0, fiber: 35.2, sugars: 50.8, fat: 76.4, protein: 98.2, vitA: 1697.6, vitC: 220.1, vitD: 454.1, vitE: 14.5, calcium: 1229.8, iron: 13.4, magnesium: 525.5, potassium: 4269.7, sodium: 1684.8, zinc: 14.3, mono: 26.6, omega3: 4.4, omega6: 10.1 },
            { date: '18/11/2025', energy: 1918.0, carbs: 215.8, fiber: 31.6, sugars: 56.9, fat: 80.6, protein: 99.2, vitA: 1149.4, vitC: 248.9, vitD: 441.5, vitE: 17.2, calcium: 1183.6, iron: 11.6, magnesium: 453.4, potassium: 3977.8, sodium: 1497.2, zinc: 11.9, mono: 29.8, omega3: 4.5, omega6: 11.3 },
            { date: '19/11/2025', energy: 1814.8, carbs: 208.3, fiber: 32.3, sugars: 60.9, fat: 75.4, protein: 97.9, vitA: 1494.1, vitC: 236.4, vitD: 454.1, vitE: 15.4, calcium: 1189.0, iron: 14.9, magnesium: 494.8, potassium: 4138.3, sodium: 1507.1, zinc: 14.4, mono: 26.4, omega3: 4.4, omega6: 10.0 },
            { date: '20/11/2025', energy: 1867.1, carbs: 205.9, fiber: 29.0, sugars: 53.5, fat: 80.0, protein: 99.1, vitA: 1200.8, vitC: 215.7, vitD: 454.1, vitE: 14.6, calcium: 1200.1, iron: 16.4, magnesium: 519.8, potassium: 4221.2, sodium: 1563.3, zinc: 15.5, mono: 32.0, omega3: 2.3, omega6: 10.9 },
            { date: '21/11/2025', energy: 1933.6, carbs: 211.5, fiber: 37.2, sugars: 53.4, fat: 87.0, protein: 102.5, vitA: 1082.1, vitC: 148.8, vitD: 441.5, vitE: 15.2, calcium: 1255.0, iron: 13.3, magnesium: 587.6, potassium: 4538.5, sodium: 1748.5, zinc: 12.9, mono: 31.6, omega3: 5.6, omega6: 11.7 },
            { date: '22/11/2025', energy: 1996.7, carbs: 212.4, fiber: 43.6, sugars: 45.8, fat: 93.9, protein: 106.4, vitA: 1299.4, vitC: 245.2, vitD: 512.9, vitE: 16.6, calcium: 1360.4, iron: 19.3, magnesium: 602.3, potassium: 4393.6, sodium: 2154.4, zinc: 15.5, mono: 35.1, omega3: 7.1, omega6: 12.2 },
            { date: '23/11/2025', energy: 1964.3, carbs: 224.1, fiber: 36.6, sugars: 72.3, fat: 87.2, protein: 100.4, vitA: 1717.3, vitC: 200.1, vitD: 454.1, vitE: 14.4, calcium: 1213.9, iron: 14.1, magnesium: 551.9, potassium: 4228.7, sodium: 1520.5, zinc: 15.0, mono: 31.8, omega3: 5.6, omega6: 11.8 },
            { date: '24/11/2025', energy: 1834.6, carbs: 200.6, fiber: 37.6, sugars: 45.8, fat: 82.3, protein: 100.4, vitA: 985.1, vitC: 202.6, vitD: 512.9, vitE: 15.3, calcium: 1311.8, iron: 19.4, magnesium: 607.0, potassium: 4591.7, sodium: 1685.3, zinc: 15.2, mono: 30.5, omega3: 4.7, omega6: 10.3 },
            { date: '25/11/2025', energy: 1958.3, carbs: 220.7, fiber: 35.0, sugars: 63.6, fat: 85.4, protein: 100.8, vitA: 1420.7, vitC: 239.4, vitD: 454.1, vitE: 16.2, calcium: 1169.4, iron: 16.6, magnesium: 593.8, potassium: 4384.8, sodium: 1575.2, zinc: 15.6, mono: 32.1, omega3: 4.7, omega6: 11.8 },
            { date: '26/11/2025', energy: 1905.9, carbs: 206.7, fiber: 29.4, sugars: 61.5, fat: 84.9, protein: 96.8, vitA: 1514.7, vitC: 154.7, vitD: 505.2, vitE: 16.3, calcium: 1204.4, iron: 16.1, magnesium: 529.6, potassium: 4273.4, sodium: 1548.1, zinc: 14.7, mono: 33.0, omega3: 4.8, omega6: 11.2 },
            { date: '27/11/2025', energy: 1872.9, carbs: 209.1, fiber: 28.6, sugars: 62.5, fat: 78.1, protein: 96.9, vitA: 1319.3, vitC: 136.3, vitD: 446.4, vitE: 13.8, calcium: 1131.8, iron: 15.2, magnesium: 456.0, potassium: 3885.9, sodium: 1602.8, zinc: 13.8, mono: 29.0, omega3: 4.6, omega6: 10.8 },
            { date: '28/11/2025', energy: 1926.6, carbs: 213.3, fiber: 28.4, sugars: 70.1, fat: 85.0, protein: 93.7, vitA: 1594.4, vitC: 150.9, vitD: 498.2, vitE: 15.1, calcium: 1177.7, iron: 13.4, magnesium: 517.5, potassium: 4092.7, sodium: 1568.3, zinc: 13.9, mono: 32.1, omega3: 5.9, omega6: 11.4 },
            { date: '29/11/2025', energy: 1919.8, carbs: 217.0, fiber: 36.4, sugars: 60.2, fat: 87.7, protein: 91.9, vitA: 1399.3, vitC: 160.4, vitD: 436.5, vitE: 17.4, calcium: 1221.0, iron: 18.6, magnesium: 533.5, potassium: 4172.7, sodium: 1644.7, zinc: 18.4, mono: 32.1, omega3: 5.8, omega6: 10.4 },
            { date: '30/11/2025', energy: 1874.6, carbs: 209.7, fiber: 30.3, sugars: 58.0, fat: 80.0, protein: 97.8, vitA: 1187.4, vitC: 165.9, vitD: 433.6, vitE: 16.4, calcium: 1186.4, iron: 17.1, magnesium: 489.1, potassium: 4014.7, sodium: 1561.0, zinc: 11.7, mono: 28.6, omega3: 5.7, omega6: 10.9 }
        ];

        // Tính toán các giá trị trung bình
        const avgEnergy = nutritionData.reduce((sum, day) => sum + day.energy, 0) / nutritionData.length;
        const avgCarbs = nutritionData.reduce((sum, day) => sum + day.carbs, 0) / nutritionData.length;
        const avgProtein = nutritionData.reduce((sum, day) => sum + day.protein, 0) / nutritionData.length;
        const avgFat = nutritionData.reduce((sum, day) => sum + day.fat, 0) / nutritionData.length;
        const avgFiber = nutritionData.reduce((sum, day) => sum + day.fiber, 0) / nutritionData.length;
        const avgSugar = nutritionData.reduce((sum, day) => sum + day.sugars, 0) / nutritionData.length;
        
        // Tính tỷ lệ phần trăm của các chất dinh dưỡng đa lượng
        const carbsPct = (avgCarbs * 4 / avgEnergy * 100).toFixed(1);
        const proteinPct = (avgProtein * 4 / avgEnergy * 100).toFixed(1);
        const fatPct = (avgFat * 9 / avgEnergy * 100).toFixed(1);
        
        // Cập nhật các giá trị trung bình trong HTML
        document.getElementById('avgEnergy').textContent = avgEnergy.toFixed(1);
        document.getElementById('avgCarbsPct').textContent = carbsPct + '%';
        document.getElementById('avgProteinPct').textContent = proteinPct + '%';
        document.getElementById('avgFatPct').textContent = fatPct + '%';
        document.getElementById('avgFiber').textContent = avgFiber.toFixed(1);
        document.getElementById('avgSugar').textContent = avgSugar.toFixed(1);
        
        // Tính tỷ lệ chất béo không bão hòa
        const totalMono = nutritionData.reduce((sum, day) => sum + day.mono, 0);
        const totalOmega3 = nutritionData.reduce((sum, day) => sum + day.omega3, 0);
        const totalOmega6 = nutritionData.reduce((sum, day) => sum + day.omega6, 0);
        const totalUnsaturated = totalMono + totalOmega3 + totalOmega6;
        const totalFat = nutritionData.reduce((sum, day) => sum + day.fat, 0);
        const unsaturatedRatio = ((totalUnsaturated / totalFat) * 100).toFixed(1);
        
        document.getElementById('unsaturatedRatio').textContent = unsaturatedRatio + '%';
        
        // Tính tỷ lệ Omega-3/Omega-6
        const omegaRatio = (totalOmega6 / totalOmega3).toFixed(1);
        document.getElementById('omegaRatio').textContent = '1:' + omegaRatio;

        // Biểu đồ năng lượng
        const energyCtx = document.getElementById('energyChart').getContext('2d');
        const energyChart = new Chart(energyCtx, {
            type: 'line',
            data: {
                labels: nutritionData.map(day => day.date.substring(0, 5)),
                datasets: [{
                    label: 'Năng lượng (kcal)',
                    data: nutritionData.map(day => day.energy),
                    borderColor: '#3498db',
                    backgroundColor: 'rgba(52, 152, 219, 0.1)',
                    tension: 0.3,
                    fill: true
                }, {
                    label: 'Mục tiêu (1700 kcal)',
                    data: Array(nutritionData.length).fill(1700),
                    borderColor: '#2ecc71',
                    borderDash: [5, 5],
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Kcal'
                        }
                    }
                }
            }
        });

        // Biểu đồ phân bố dinh dưỡng
        const macroCtx = document.getElementById('macronutrientChart').getContext('2d');
        const macroChart = new Chart(macroCtx, {
            type: 'doughnut',
            data: {
                labels: ['Carbohydrate', 'Protein', 'Chất béo'],
                datasets: [{
                    data: [carbsPct, proteinPct, fatPct],
                    backgroundColor: [
                        '#f39c12',
                        '#2ecc71',
                        '#e74c3c'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        // Biểu đồ chất xơ và đường
        const fiberSugarCtx = document.getElementById('fiberSugarChart').getContext('2d');
        const fiberSugarChart = new Chart(fiberSugarCtx, {
            type: 'bar',
            data: {
                labels: nutritionData.map(day => day.date.substring(0, 5)),
                datasets: [{
                    label: 'Chất xơ (g)',
                    data: nutritionData.map(day => day.fiber),
                    backgroundColor: 'rgba(46, 204, 113, 0.7)'
                }, {
                    label: 'Đường (g)',
                    data: nutritionData.map(day => day.sugars),
                    backgroundColor: 'rgba(243, 156, 18, 0.7)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        display: false
                    },
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Gam'
                        }
                    }
                }
            }
        });

        // Biểu đồ vitamin
        const vitaminCtx = document.getElementById('vitaminChart').getContext('2d');
        const vitaminChart = new Chart(vitaminCtx, {
            type: 'radar',
            data: {
                labels: ['Vitamin A', 'Vitamin C', 'Vitamin D', 'Vitamin E', 'Calcium', 'Sắt', 'Kẽm'],
                datasets: [{
                    label: 'Trung bình hàng ngày',
                    data: [
                        nutritionData.reduce((sum, day) => sum + day.vitA, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.vitC, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.vitD, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.vitE, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.calcium, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.iron, 0) / nutritionData.length,
                        nutritionData.reduce((sum, day) => sum + day.zinc, 0) / nutritionData.length
                    ],
                    backgroundColor: 'rgba(52, 152, 219, 0.2)',
                    borderColor: '#3498db',
                    pointBackgroundColor: '#3498db'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Biểu đồ chất béo chi tiết
        const fatBreakdownCtx = document.getElementById('fatBreakdownChart').getContext('2d');
        const fatBreakdownChart = new Chart(fatBreakdownCtx, {
            type: 'pie',
            data: {
                labels: ['Chất béo không bão hòa đơn', 'Omega-3', 'Omega-6', 'Chất béo bão hòa'],
                datasets: [{
                    data: [
                        totalMono / totalFat * 100,
                        totalOmega3 / totalFat * 100,
                        totalOmega6 / totalFat * 100,
                        100 - (totalUnsaturated / totalFat * 100)
                    ],
                    backgroundColor: [
                        '#3498db',
                        '#2ecc71',
                        '#f39c12',
                        '#e74c3c'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });
    </script>
</body>
</html>